<!DOCTYPE html><html><head><title>1.单播委托：一个委托封装一个方法的形式</title><meta charset='utf-8'><link href='https://cdn.maxiang.io/res-min/themes/marxico.css' rel='stylesheet'><style>
.note-content  {font-family: "Helvetica Neue",Arial,"Hiragino Sans GB","STHeiti","Microsoft YaHei","WenQuanYi Micro Hei",SimSun,Song,sans-serif;}

</style></head><body><div id='preview-contents' class='note-content'>
                        
                    

<blockquote>
  <p>委托的高级使用</p>
</blockquote>

<hr>



<h4 id="1单播委托一个委托封装一个方法的形式">1.单播委托：一个委托封装一个方法的形式</h4>



<pre class="prettyprint with-line-number hljs-dark"><code class="hljs cs"><div class="hljs-line"><span class="hljs-comment line-number">1.</span><span class="hljs-keyword">using</span> System;
</div><div class="hljs-line"><span class="hljs-comment line-number">2.</span><span class="hljs-keyword">using</span> System.Threading;
</div><div class="hljs-line"><span class="hljs-comment line-number">3.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">4.</span><span class="hljs-keyword">namespace</span> <span class="hljs-title">Delegate</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">5.</span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">6.</span>    <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">7.</span>    {
</div><div class="hljs-line"><span class="hljs-comment line-number">8.</span>        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-keyword">string</span>[] args</span>)</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">9.</span><span class="hljs-function">        </span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">10.</span>            Student stu1 = <span class="hljs-keyword">new</span> Student() { ID = <span class="hljs-number">1</span>, PenColor = ConsoleColor.Red };<span class="hljs-comment">//创建三个学生实例</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">11.</span>            Student stu2 = <span class="hljs-keyword">new</span> Student() { ID = <span class="hljs-number">2</span>, PenColor = ConsoleColor.Blue };
</div><div class="hljs-line"><span class="hljs-comment line-number">12.</span>            Student stu3 = <span class="hljs-keyword">new</span> Student() { ID = <span class="hljs-number">3</span>, PenColor = ConsoleColor.Green };
</div><div class="hljs-line"><span class="hljs-comment line-number">13.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">14.</span>            Action action1 = stu1.DoHomework;<span class="hljs-comment">//使用委托调用学生类中的DoHomework方法</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">15.</span>            Action action2 = stu2.DoHomework;
</div><div class="hljs-line"><span class="hljs-comment line-number">16.</span>            Action action3 = stu3.DoHomework;
</div><div class="hljs-line"><span class="hljs-comment line-number">17.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">18.</span>            action1.Invoke();
</div><div class="hljs-line"><span class="hljs-comment line-number">19.</span>            action2();
</div><div class="hljs-line"><span class="hljs-comment line-number">20.</span>            action3();
</div><div class="hljs-line"><span class="hljs-comment line-number">21.</span>        }
</div><div class="hljs-line"><span class="hljs-comment line-number">22.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">23.</span>    <span class="hljs-keyword">class</span> <span class="hljs-title">Student</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">24.</span>    {
</div><div class="hljs-line"><span class="hljs-comment line-number">25.</span>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> ID { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
</div><div class="hljs-line"><span class="hljs-comment line-number">26.</span>        <span class="hljs-keyword">public</span> ConsoleColor PenColor { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
</div><div class="hljs-line"><span class="hljs-comment line-number">27.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">28.</span>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DoHomework</span>(<span class="hljs-params"></span>)</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">29.</span><span class="hljs-function">        </span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">30.</span>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++)
</div><div class="hljs-line"><span class="hljs-comment line-number">31.</span>            {
</div><div class="hljs-line"><span class="hljs-comment line-number">32.</span>                <span class="hljs-comment">//Console.ForegroundColor()获取或设置控制台的前景色。</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">33.</span>                <span class="hljs-comment">//例：Console.BackgroundColor=ConsoleColor.Red;(背景色)</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">34.</span>                Console.ForegroundColor = <span class="hljs-keyword">this</span>.PenColor;
</div><div class="hljs-line"><span class="hljs-comment line-number">35.</span>                Console.WriteLine(<span class="hljs-string">"student {0} doing homework {1} hours."</span>, <span class="hljs-keyword">this</span>.ID, i);
</div><div class="hljs-line"><span class="hljs-comment line-number">36.</span>                Thread.Sleep(<span class="hljs-number">1000</span>);
</div><div class="hljs-line"><span class="hljs-comment line-number">37.</span>            }
</div><div class="hljs-line"><span class="hljs-comment line-number">38.</span>        }
</div><div class="hljs-line"><span class="hljs-comment line-number">39.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">40.</span>}
</div></code></pre>

<hr>



<h4 id="2多播委托">2.多播委托</h4>



<pre class="prettyprint with-line-number hljs-dark"><code class="hljs cs"><div class="hljs-line"><span class="hljs-comment line-number">1.</span><span class="hljs-keyword">using</span> System;
</div><div class="hljs-line"><span class="hljs-comment line-number">2.</span><span class="hljs-keyword">using</span> System.Threading;
</div><div class="hljs-line"><span class="hljs-comment line-number">3.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">4.</span><span class="hljs-keyword">namespace</span> <span class="hljs-title">Delegate</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">5.</span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">6.</span>    <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">7.</span>    {
</div><div class="hljs-line"><span class="hljs-comment line-number">8.</span>        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-keyword">string</span>[] args</span>)</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">9.</span><span class="hljs-function">        </span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">10.</span>            Student stu1 = <span class="hljs-keyword">new</span> Student() { ID = <span class="hljs-number">1</span>, PenColor = ConsoleColor.Red };<span class="hljs-comment">//创建三个学生实例</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">11.</span>            Student stu2 = <span class="hljs-keyword">new</span> Student() { ID = <span class="hljs-number">2</span>, PenColor = ConsoleColor.Blue };
</div><div class="hljs-line"><span class="hljs-comment line-number">12.</span>            Student stu3 = <span class="hljs-keyword">new</span> Student() { ID = <span class="hljs-number">3</span>, PenColor = ConsoleColor.Green };
</div><div class="hljs-line"><span class="hljs-comment line-number">13.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">14.</span>            Action action1 = stu1.DoHomework;<span class="hljs-comment">//使用委托调用学生类中的DoHomework方法</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">15.</span>            Action action2 = stu2.DoHomework;
</div><div class="hljs-line"><span class="hljs-comment line-number">16.</span>            Action action3 = stu3.DoHomework;
</div><div class="hljs-line"><span class="hljs-comment line-number">17.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">18.</span>            action1 += action2;
</div><div class="hljs-line"><span class="hljs-comment line-number">19.</span>            action1 += action3;
</div><div class="hljs-line"><span class="hljs-comment line-number">20.</span>            action1.Invoke();<span class="hljs-comment">//三个实例的委托合并到一个委托中</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">21.</span>        }
</div><div class="hljs-line"><span class="hljs-comment line-number">22.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">23.</span>    <span class="hljs-keyword">class</span> <span class="hljs-title">Student</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">24.</span>    {
</div><div class="hljs-line"><span class="hljs-comment line-number">25.</span>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> ID { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
</div><div class="hljs-line"><span class="hljs-comment line-number">26.</span>        <span class="hljs-keyword">public</span> ConsoleColor PenColor { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
</div><div class="hljs-line"><span class="hljs-comment line-number">27.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">28.</span>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DoHomework</span>(<span class="hljs-params"></span>)</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">29.</span><span class="hljs-function">        </span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">30.</span>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++)
</div><div class="hljs-line"><span class="hljs-comment line-number">31.</span>            {
</div><div class="hljs-line"><span class="hljs-comment line-number">32.</span>                <span class="hljs-comment">//Console.ForegroundColor()获取或设置控制台的前景色。</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">33.</span>                <span class="hljs-comment">//例：Console.BackgroundColor=ConsoleColor.Red;(背景色)</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">34.</span>                Console.ForegroundColor = <span class="hljs-keyword">this</span>.PenColor;
</div><div class="hljs-line"><span class="hljs-comment line-number">35.</span>                Console.WriteLine(<span class="hljs-string">"student {0} doing homework {1} hours."</span>, <span class="hljs-keyword">this</span>.ID, i);
</div><div class="hljs-line"><span class="hljs-comment line-number">36.</span>                Thread.Sleep(<span class="hljs-number">1000</span>);
</div><div class="hljs-line"><span class="hljs-comment line-number">37.</span>            }
</div><div class="hljs-line"><span class="hljs-comment line-number">38.</span>        }
</div><div class="hljs-line"><span class="hljs-comment line-number">39.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">40.</span>}
</div></code></pre>



<h5 id="结果如下">结果如下：</h5>



<pre class="prettyprint with-line-number hljs-dark"><code class="hljs lsl"><div class="hljs-line"><span class="hljs-comment line-number">1.</span>student <span class="hljs-number">1</span> doing homework <span class="hljs-number">0</span> hours.<span class="hljs-comment">//红色</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">2.</span>student <span class="hljs-number">1</span> doing homework <span class="hljs-number">1</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">3.</span>student <span class="hljs-number">1</span> doing homework <span class="hljs-number">2</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">4.</span>student <span class="hljs-number">1</span> doing homework <span class="hljs-number">3</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">5.</span>student <span class="hljs-number">1</span> doing homework <span class="hljs-number">4</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">6.</span>student <span class="hljs-number">2</span> doing homework <span class="hljs-number">0</span> hours.<span class="hljs-comment">//蓝色</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">7.</span>student <span class="hljs-number">2</span> doing homework <span class="hljs-number">1</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">8.</span>student <span class="hljs-number">2</span> doing homework <span class="hljs-number">2</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">9.</span>student <span class="hljs-number">2</span> doing homework <span class="hljs-number">3</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">10.</span>student <span class="hljs-number">2</span> doing homework <span class="hljs-number">4</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">11.</span>student <span class="hljs-number">3</span> doing homework <span class="hljs-number">0</span> hours.<span class="hljs-comment">//绿色</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">12.</span>student <span class="hljs-number">3</span> doing homework <span class="hljs-number">1</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">13.</span>student <span class="hljs-number">3</span> doing homework <span class="hljs-number">2</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">14.</span>student <span class="hljs-number">3</span> doing homework <span class="hljs-number">3</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">15.</span>student <span class="hljs-number">3</span> doing homework <span class="hljs-number">4</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">16.</span>请按任意键继续. . .
</div></code></pre>



<h4 id="3-隐式异步调用">3. 隐式异步调用</h4>



<h5 id="同步你做完了在你做的基础上我再做依次执行主线程中各个方法">同步：你做完了（在你做的基础上），我再做。（依次执行主线程中各个方法）</h5>



<h5 id="异步两人同时做同步进行不同线程抢夺资源同时进行">异步：两人同时做（同步进行）。（不同线程抢夺资源同时进行）</h5>



<h5 id="同步调用和异步调用">同步调用和异步调用：</h5>

<ul><li><h6 id="每个运行的程序是一个进程process">每个运行的程序是一个进程（Process）</h6></li>
<li><h6 id="每个进程可以有一个或多个线程thread第一个运行起来的线程叫主线程主线程之外的线程叫分支线程">每个进程可以有一个或多个线程（Thread）：第一个运行起来的线程叫主线程，主线程之外的线程叫分支线程</h6></li>
<li><h6 id="同步调用是在同一个线程内">同步调用是在同一个线程内</h6></li>
<li><h6 id="异步调用的底层基理是多线程">异步调用的底层基理是<span style="color:red;font-size:20px">多线程</span></h6></li>
<li><h6 id="串行-同步-单线程-并行-异步-多线程">串行 == 同步 == 单线程    并行 ==异步 ==多线程</h6></li>
</ul>



<h5 id="隐式多线程和显式多线程">隐式多线程和显式多线程</h5>

<ul><li><h6 id="直接同步调用使用方法名">直接同步调用：使用方法名</h6></li>
<li><h6 id="间接同步调用使用单播多播委托的invoke方法">间接同步调用：使用单播/多播委托的Invoke方法</h6></li>
<li><h6 id="隐式异步调用使用委托的begininvoke">隐式异步调用：使用委托的BeginInvoke</h6></li>
<li><h6 id="显式异步调用使用thread或task">显式异步调用：使用Thread或Task</h6></li>
</ul>



<h5 id="适当的使用接口interface取代一些对委托的使用java中没有委托它完全用接口取代了"><div style="background:yellow">适当的使用接口（interface)取代一些对委托的使用（java中没有委托，它完全用接口取代了）</div></h5>

<hr>



<h5 id="直接同步调用">直接同步调用</h5>



<pre class="prettyprint with-line-number hljs-dark"><code class="hljs cs"><div class="hljs-line"><span class="hljs-comment line-number">1.</span><span class="hljs-keyword">using</span> System;
</div><div class="hljs-line"><span class="hljs-comment line-number">2.</span><span class="hljs-keyword">using</span> System.Threading;
</div><div class="hljs-line"><span class="hljs-comment line-number">3.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">4.</span><span class="hljs-keyword">namespace</span> <span class="hljs-title">Delegate</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">5.</span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">6.</span>    <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">7.</span>    {
</div><div class="hljs-line"><span class="hljs-comment line-number">8.</span>        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-keyword">string</span>[] args</span>)</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">9.</span><span class="hljs-function">        </span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">10.</span>            Student stu1 = <span class="hljs-keyword">new</span> Student() { ID = <span class="hljs-number">1</span>, PenColor = ConsoleColor.Red };<span class="hljs-comment">//创建三个学生实例</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">11.</span>            Student stu2 = <span class="hljs-keyword">new</span> Student() { ID = <span class="hljs-number">2</span>, PenColor = ConsoleColor.Blue };
</div><div class="hljs-line"><span class="hljs-comment line-number">12.</span>            Student stu3 = <span class="hljs-keyword">new</span> Student() { ID = <span class="hljs-number">3</span>, PenColor = ConsoleColor.Green };
</div><div class="hljs-line"><span class="hljs-comment line-number">13.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">14.</span>            stu1.DoHomework();<span class="hljs-comment">//直接用对象来调用方法</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">15.</span>            stu2.DoHomework();
</div><div class="hljs-line"><span class="hljs-comment line-number">16.</span>            stu3.DoHomework();
</div><div class="hljs-line"><span class="hljs-comment line-number">17.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">18.</span>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++)<span class="hljs-comment">//主线程还有一些事情需要做。。。。</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">19.</span>            {
</div><div class="hljs-line"><span class="hljs-comment line-number">20.</span>                Console.ForegroundColor = ConsoleColor.Cyan;
</div><div class="hljs-line"><span class="hljs-comment line-number">21.</span>                Console.WriteLine(<span class="hljs-string">"Main thread {0}"</span>, i);
</div><div class="hljs-line"><span class="hljs-comment line-number">22.</span>                Thread.Sleep(<span class="hljs-number">1000</span>);
</div><div class="hljs-line"><span class="hljs-comment line-number">23.</span>            }
</div><div class="hljs-line"><span class="hljs-comment line-number">24.</span>        }
</div><div class="hljs-line"><span class="hljs-comment line-number">25.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">26.</span>    <span class="hljs-keyword">class</span> <span class="hljs-title">Student</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">27.</span>    {
</div><div class="hljs-line"><span class="hljs-comment line-number">28.</span>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> ID { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
</div><div class="hljs-line"><span class="hljs-comment line-number">29.</span>        <span class="hljs-keyword">public</span> ConsoleColor PenColor { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
</div><div class="hljs-line"><span class="hljs-comment line-number">30.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">31.</span>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DoHomework</span>(<span class="hljs-params"></span>)</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">32.</span><span class="hljs-function">        </span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">33.</span>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++)
</div><div class="hljs-line"><span class="hljs-comment line-number">34.</span>            {
</div><div class="hljs-line"><span class="hljs-comment line-number">35.</span>                <span class="hljs-comment">//Console.ForegroundColor()获取或设置控制台的前景色。</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">36.</span>                <span class="hljs-comment">//例：Console.BackgroundColor=ConsoleColor.Red;(背景色)</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">37.</span>                Console.ForegroundColor = <span class="hljs-keyword">this</span>.PenColor;
</div><div class="hljs-line"><span class="hljs-comment line-number">38.</span>                Console.WriteLine(<span class="hljs-string">"student {0} doing homework {1} hours."</span>, <span class="hljs-keyword">this</span>.ID, i);
</div><div class="hljs-line"><span class="hljs-comment line-number">39.</span>                Thread.Sleep(<span class="hljs-number">1000</span>);
</div><div class="hljs-line"><span class="hljs-comment line-number">40.</span>            }
</div><div class="hljs-line"><span class="hljs-comment line-number">41.</span>        }
</div><div class="hljs-line"><span class="hljs-comment line-number">42.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">43.</span>}
</div></code></pre>



<h5 id="运行结果">运行结果：</h5>



<pre class="prettyprint with-line-number hljs-dark"><code class="hljs lsl"><div class="hljs-line"><span class="hljs-comment line-number">1.</span>student <span class="hljs-number">1</span> doing homework <span class="hljs-number">0</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">2.</span>student <span class="hljs-number">1</span> doing homework <span class="hljs-number">1</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">3.</span>student <span class="hljs-number">1</span> doing homework <span class="hljs-number">2</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">4.</span>student <span class="hljs-number">1</span> doing homework <span class="hljs-number">3</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">5.</span>student <span class="hljs-number">1</span> doing homework <span class="hljs-number">4</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">6.</span>student <span class="hljs-number">2</span> doing homework <span class="hljs-number">0</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">7.</span>student <span class="hljs-number">2</span> doing homework <span class="hljs-number">1</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">8.</span>student <span class="hljs-number">2</span> doing homework <span class="hljs-number">2</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">9.</span>student <span class="hljs-number">2</span> doing homework <span class="hljs-number">3</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">10.</span>student <span class="hljs-number">2</span> doing homework <span class="hljs-number">4</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">11.</span>student <span class="hljs-number">3</span> doing homework <span class="hljs-number">0</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">12.</span>student <span class="hljs-number">3</span> doing homework <span class="hljs-number">1</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">13.</span>student <span class="hljs-number">3</span> doing homework <span class="hljs-number">2</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">14.</span>student <span class="hljs-number">3</span> doing homework <span class="hljs-number">3</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">15.</span>student <span class="hljs-number">3</span> doing homework <span class="hljs-number">4</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">16.</span>Main thread <span class="hljs-number">0</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">17.</span>Main thread <span class="hljs-number">1</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">18.</span>Main thread <span class="hljs-number">2</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">19.</span>Main thread <span class="hljs-number">3</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">20.</span>Main thread <span class="hljs-number">4</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">21.</span>Main thread <span class="hljs-number">5</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">22.</span>Main thread <span class="hljs-number">6</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">23.</span>Main thread <span class="hljs-number">7</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">24.</span>Main thread <span class="hljs-number">8</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">25.</span>Main thread <span class="hljs-number">9</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">26.</span>请按任意键继续. . .
</div></code></pre>

<hr>



<h5 id="间接同步调用单播间接同步调用多播间接同步调用">间接同步调用：单播间接同步调用；多播间接同步调用</h5>



<h6 id="通过委托来调用多播委托也是同步调用的同步使用invoke方法">通过委托来调用：多播委托也是同步调用的。同步使用Invoke方法</h6>

<div style="background:#f0baba;text-align:center">这里只能通过基于.NET Framework的控制台程序来运行，.NET core的控制台程序会报错</div>



<pre class="prettyprint with-line-number hljs-dark"><code class="hljs cs"><div class="hljs-line"><span class="hljs-comment line-number">1.</span><span class="hljs-keyword">using</span> System;
</div><div class="hljs-line"><span class="hljs-comment line-number">2.</span><span class="hljs-keyword">using</span> System.Threading;
</div><div class="hljs-line"><span class="hljs-comment line-number">3.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">4.</span><span class="hljs-keyword">namespace</span> <span class="hljs-title">Delegate</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">5.</span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">6.</span>    <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">7.</span>    {
</div><div class="hljs-line"><span class="hljs-comment line-number">8.</span>        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-keyword">string</span>[] args</span>)</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">9.</span><span class="hljs-function">        </span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">10.</span>            Student stu1 = <span class="hljs-keyword">new</span> Student() { ID = <span class="hljs-number">1</span>, PenColor = ConsoleColor.Red };<span class="hljs-comment">//创建三个学生实例</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">11.</span>            Student stu2 = <span class="hljs-keyword">new</span> Student() { ID = <span class="hljs-number">2</span>, PenColor = ConsoleColor.Blue };
</div><div class="hljs-line"><span class="hljs-comment line-number">12.</span>            Student stu3 = <span class="hljs-keyword">new</span> Student() { ID = <span class="hljs-number">3</span>, PenColor = ConsoleColor.Green };
</div><div class="hljs-line"><span class="hljs-comment line-number">13.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">14.</span>            Action action1 = <span class="hljs-keyword">new</span> Action(stu1.DoHomework);<span class="hljs-comment">//通过委托来调用</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">15.</span>            Action action2 = <span class="hljs-keyword">new</span> Action(stu2.DoHomework);
</div><div class="hljs-line"><span class="hljs-comment line-number">16.</span>            Action action3 = <span class="hljs-keyword">new</span> Action(stu3.DoHomework);
</div><div class="hljs-line"><span class="hljs-comment line-number">17.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">18.</span>            action1.Invoke();<span class="hljs-comment">//单播委托的同步调用,使用Invoke是同步调用</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">19.</span>            action2();
</div><div class="hljs-line"><span class="hljs-comment line-number">20.</span>            action3();
</div><div class="hljs-line"><span class="hljs-comment line-number">21.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">22.</span>            <span class="hljs-comment">//action1 += action2;//多播委托（也是同步调用的）</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">23.</span>            <span class="hljs-comment">//action1 += action3;</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">24.</span>            <span class="hljs-comment">//action1();</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">25.</span>        }
</div><div class="hljs-line"><span class="hljs-comment line-number">26.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">27.</span>    <span class="hljs-keyword">class</span> <span class="hljs-title">Student</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">28.</span>    {
</div><div class="hljs-line"><span class="hljs-comment line-number">29.</span>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> ID { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
</div><div class="hljs-line"><span class="hljs-comment line-number">30.</span>        <span class="hljs-keyword">public</span> ConsoleColor PenColor { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
</div><div class="hljs-line"><span class="hljs-comment line-number">31.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">32.</span>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DoHomework</span>(<span class="hljs-params"></span>)</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">33.</span><span class="hljs-function">        </span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">34.</span>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++)
</div><div class="hljs-line"><span class="hljs-comment line-number">35.</span>            {
</div><div class="hljs-line"><span class="hljs-comment line-number">36.</span>                <span class="hljs-comment">//Console.ForegroundColor()获取或设置控制台的前景色。</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">37.</span>                <span class="hljs-comment">//例：Console.BackgroundColor=ConsoleColor.Red;(背景色)</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">38.</span>                Console.ForegroundColor = <span class="hljs-keyword">this</span>.PenColor;
</div><div class="hljs-line"><span class="hljs-comment line-number">39.</span>                Console.WriteLine(<span class="hljs-string">"student {0} doing homework {1} hours."</span>, <span class="hljs-keyword">this</span>.ID, i);
</div><div class="hljs-line"><span class="hljs-comment line-number">40.</span>                Thread.Sleep(<span class="hljs-number">1000</span>);
</div><div class="hljs-line"><span class="hljs-comment line-number">41.</span>            }
</div><div class="hljs-line"><span class="hljs-comment line-number">42.</span>        }
</div><div class="hljs-line"><span class="hljs-comment line-number">43.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">44.</span>}
</div></code></pre>

<hr>



<h5 id="间接隐式异步调用使用委托异步begininvoke">间接隐式异步调用（使用委托）（异步：BeginInvoke）</h5>



<pre class="prettyprint with-line-number hljs-dark"><code class="hljs cs"><div class="hljs-line"><span class="hljs-comment line-number">1.</span><span class="hljs-keyword">using</span> System;
</div><div class="hljs-line"><span class="hljs-comment line-number">2.</span><span class="hljs-keyword">using</span> System.Threading;
</div><div class="hljs-line"><span class="hljs-comment line-number">3.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">4.</span><span class="hljs-keyword">namespace</span> <span class="hljs-title">Delegate</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">5.</span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">6.</span>    <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">7.</span>    {
</div><div class="hljs-line"><span class="hljs-comment line-number">8.</span>        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-keyword">string</span>[] args</span>)</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">9.</span><span class="hljs-function">        </span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">10.</span>            Student stu1 = <span class="hljs-keyword">new</span> Student() { ID = <span class="hljs-number">1</span>, PenColor = ConsoleColor.Red };<span class="hljs-comment">//创建三个学生实例</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">11.</span>            Student stu2 = <span class="hljs-keyword">new</span> Student() { ID = <span class="hljs-number">2</span>, PenColor = ConsoleColor.Blue };
</div><div class="hljs-line"><span class="hljs-comment line-number">12.</span>            Student stu3 = <span class="hljs-keyword">new</span> Student() { ID = <span class="hljs-number">3</span>, PenColor = ConsoleColor.Green };
</div><div class="hljs-line"><span class="hljs-comment line-number">13.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">14.</span>            Action action1 = <span class="hljs-keyword">new</span> Action(stu1.DoHomework);<span class="hljs-comment">//通过委托来调用</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">15.</span>            Action action2 = <span class="hljs-keyword">new</span> Action(stu2.DoHomework);
</div><div class="hljs-line"><span class="hljs-comment line-number">16.</span>            Action action3 = <span class="hljs-keyword">new</span> Action(stu3.DoHomework);
</div><div class="hljs-line"><span class="hljs-comment line-number">17.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">18.</span>            action1.BeginInvoke(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);
</div><div class="hljs-line"><span class="hljs-comment line-number">19.</span>            action2.BeginInvoke(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);
</div><div class="hljs-line"><span class="hljs-comment line-number">20.</span>            action3.BeginInvoke(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);
</div><div class="hljs-line"><span class="hljs-comment line-number">21.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">22.</span>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++)
</div><div class="hljs-line"><span class="hljs-comment line-number">23.</span>            {
</div><div class="hljs-line"><span class="hljs-comment line-number">24.</span>                Console.ForegroundColor = ConsoleColor.Cyan;
</div><div class="hljs-line"><span class="hljs-comment line-number">25.</span>                Console.WriteLine(<span class="hljs-string">"Main Thread {0}"</span>, i);
</div><div class="hljs-line"><span class="hljs-comment line-number">26.</span>                Thread.Sleep(<span class="hljs-number">1000</span>);
</div><div class="hljs-line"><span class="hljs-comment line-number">27.</span>            }
</div><div class="hljs-line"><span class="hljs-comment line-number">28.</span>        }
</div><div class="hljs-line"><span class="hljs-comment line-number">29.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">30.</span>    <span class="hljs-keyword">class</span> <span class="hljs-title">Student</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">31.</span>    {
</div><div class="hljs-line"><span class="hljs-comment line-number">32.</span>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> ID { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
</div><div class="hljs-line"><span class="hljs-comment line-number">33.</span>        <span class="hljs-keyword">public</span> ConsoleColor PenColor { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
</div><div class="hljs-line"><span class="hljs-comment line-number">34.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">35.</span>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DoHomework</span>(<span class="hljs-params"></span>)</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">36.</span><span class="hljs-function">        </span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">37.</span>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++)
</div><div class="hljs-line"><span class="hljs-comment line-number">38.</span>            {
</div><div class="hljs-line"><span class="hljs-comment line-number">39.</span>                <span class="hljs-comment">//Console.ForegroundColor()获取或设置控制台的前景色。</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">40.</span>                <span class="hljs-comment">//例：Console.BackgroundColor=ConsoleColor.Red;(背景色)</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">41.</span>                Console.ForegroundColor = <span class="hljs-keyword">this</span>.PenColor;
</div><div class="hljs-line"><span class="hljs-comment line-number">42.</span>                Console.WriteLine(<span class="hljs-string">"student {0} doing homework {1} hours."</span>, <span class="hljs-keyword">this</span>.ID, i);
</div><div class="hljs-line"><span class="hljs-comment line-number">43.</span>                Thread.Sleep(<span class="hljs-number">1000</span>);
</div><div class="hljs-line"><span class="hljs-comment line-number">44.</span>            }
</div><div class="hljs-line"><span class="hljs-comment line-number">45.</span>        }
</div><div class="hljs-line"><span class="hljs-comment line-number">46.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">47.</span>}
</div></code></pre>



<h5 id="运行结果-1">运行结果：</h5>



<pre class="prettyprint with-line-number hljs-dark"><code class="hljs lsl"><div class="hljs-line"><span class="hljs-comment line-number">1.</span>student <span class="hljs-number">1</span> doing homework <span class="hljs-number">0</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">2.</span>student <span class="hljs-number">3</span> doing homework <span class="hljs-number">0</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">3.</span>student <span class="hljs-number">2</span> doing homework <span class="hljs-number">0</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">4.</span>Main Thread <span class="hljs-number">1</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">5.</span>student <span class="hljs-number">1</span> doing homework <span class="hljs-number">1</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">6.</span>student <span class="hljs-number">3</span> doing homework <span class="hljs-number">1</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">7.</span>student <span class="hljs-number">2</span> doing homework <span class="hljs-number">1</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">8.</span>Main Thread <span class="hljs-number">2</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">9.</span>student <span class="hljs-number">1</span> doing homework <span class="hljs-number">2</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">10.</span>student <span class="hljs-number">2</span> doing homework <span class="hljs-number">2</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">11.</span>student <span class="hljs-number">3</span> doing homework <span class="hljs-number">2</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">12.</span>Main Thread <span class="hljs-number">3</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">13.</span>student <span class="hljs-number">2</span> doing homework <span class="hljs-number">3</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">14.</span>student <span class="hljs-number">3</span> doing homework <span class="hljs-number">3</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">15.</span>student <span class="hljs-number">1</span> doing homework <span class="hljs-number">3</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">16.</span>student <span class="hljs-number">3</span> doing homework <span class="hljs-number">4</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">17.</span>student <span class="hljs-number">2</span> doing homework <span class="hljs-number">4</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">18.</span>student <span class="hljs-number">1</span> doing homework <span class="hljs-number">4</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">19.</span>Main Thread <span class="hljs-number">4</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">20.</span>Main Thread <span class="hljs-number">5</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">21.</span>Main Thread <span class="hljs-number">6</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">22.</span>Main Thread <span class="hljs-number">7</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">23.</span>Main Thread <span class="hljs-number">8</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">24.</span>Main Thread <span class="hljs-number">9</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">25.</span>请按任意键继续. . .
</div></code></pre>

<hr>



<h4 id="显示异步调用thread-比较老的方式-task">显示异步调用:Thread (比较老的方式)    ;      Task</h4>



<h6 id="thread方式">Thread方式：</h6>



<pre class="prettyprint with-line-number hljs-dark"><code class="hljs cs"><div class="hljs-line"><span class="hljs-comment line-number">1.</span><span class="hljs-keyword">using</span> System;
</div><div class="hljs-line"><span class="hljs-comment line-number">2.</span><span class="hljs-keyword">using</span> System.Threading;
</div><div class="hljs-line"><span class="hljs-comment line-number">3.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">4.</span><span class="hljs-keyword">namespace</span> <span class="hljs-title">Delegate</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">5.</span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">6.</span>    <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">7.</span>    {
</div><div class="hljs-line"><span class="hljs-comment line-number">8.</span>        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-keyword">string</span>[] args</span>)</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">9.</span><span class="hljs-function">        </span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">10.</span>            Student stu1 = <span class="hljs-keyword">new</span> Student() { ID = <span class="hljs-number">1</span>, PenColor = ConsoleColor.Red };<span class="hljs-comment">//创建三个学生实例</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">11.</span>            Student stu2 = <span class="hljs-keyword">new</span> Student() { ID = <span class="hljs-number">2</span>, PenColor = ConsoleColor.Blue };
</div><div class="hljs-line"><span class="hljs-comment line-number">12.</span>            Student stu3 = <span class="hljs-keyword">new</span> Student() { ID = <span class="hljs-number">3</span>, PenColor = ConsoleColor.Green };
</div><div class="hljs-line"><span class="hljs-comment line-number">13.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">14.</span>            Thread thread1 = <span class="hljs-keyword">new</span> Thread(<span class="hljs-keyword">new</span> ThreadStart(stu1.DoHomework));
</div><div class="hljs-line"><span class="hljs-comment line-number">15.</span>            Thread thread2 = <span class="hljs-keyword">new</span> Thread(<span class="hljs-keyword">new</span> ThreadStart(stu2.DoHomework));
</div><div class="hljs-line"><span class="hljs-comment line-number">16.</span>            Thread thread3 = <span class="hljs-keyword">new</span> Thread(<span class="hljs-keyword">new</span> ThreadStart(stu3.DoHomework));
</div><div class="hljs-line"><span class="hljs-comment line-number">17.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">18.</span>            thread1.Start();<span class="hljs-comment">//分支线程</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">19.</span>            thread2.Start();
</div><div class="hljs-line"><span class="hljs-comment line-number">20.</span>            thread3.Start();
</div><div class="hljs-line"><span class="hljs-comment line-number">21.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">22.</span>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++)<span class="hljs-comment">//主线程</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">23.</span>            {
</div><div class="hljs-line"><span class="hljs-comment line-number">24.</span>                Console.ForegroundColor = ConsoleColor.Cyan;
</div><div class="hljs-line"><span class="hljs-comment line-number">25.</span>                Console.WriteLine(<span class="hljs-string">"Main Thread {0}"</span>, i);
</div><div class="hljs-line"><span class="hljs-comment line-number">26.</span>                Thread.Sleep(<span class="hljs-number">1000</span>);
</div><div class="hljs-line"><span class="hljs-comment line-number">27.</span>            }
</div><div class="hljs-line"><span class="hljs-comment line-number">28.</span>            <span class="hljs-comment">//运行结果：分支线程和主线程各自独立执行，谁都不等谁，有资源争抢现象</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">29.</span>        }
</div><div class="hljs-line"><span class="hljs-comment line-number">30.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">31.</span>    <span class="hljs-keyword">class</span> <span class="hljs-title">Student</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">32.</span>    {
</div><div class="hljs-line"><span class="hljs-comment line-number">33.</span>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> ID { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
</div><div class="hljs-line"><span class="hljs-comment line-number">34.</span>        <span class="hljs-keyword">public</span> ConsoleColor PenColor { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
</div><div class="hljs-line"><span class="hljs-comment line-number">35.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">36.</span>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DoHomework</span>(<span class="hljs-params"></span>)</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">37.</span><span class="hljs-function">        </span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">38.</span>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++)
</div><div class="hljs-line"><span class="hljs-comment line-number">39.</span>            {
</div><div class="hljs-line"><span class="hljs-comment line-number">40.</span>                <span class="hljs-comment">//Console.ForegroundColor()获取或设置控制台的前景色。</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">41.</span>                <span class="hljs-comment">//例：Console.BackgroundColor=ConsoleColor.Red;(背景色)</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">42.</span>                Console.ForegroundColor = <span class="hljs-keyword">this</span>.PenColor;
</div><div class="hljs-line"><span class="hljs-comment line-number">43.</span>                Console.WriteLine(<span class="hljs-string">"student {0} doing homework {1} hours."</span>, <span class="hljs-keyword">this</span>.ID, i);
</div><div class="hljs-line"><span class="hljs-comment line-number">44.</span>                Thread.Sleep(<span class="hljs-number">1000</span>);
</div><div class="hljs-line"><span class="hljs-comment line-number">45.</span>            }
</div><div class="hljs-line"><span class="hljs-comment line-number">46.</span>        }
</div><div class="hljs-line"><span class="hljs-comment line-number">47.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">48.</span>}
</div></code></pre>

<h5 id="结果">结果：</h5>



<pre class="prettyprint with-line-number hljs-dark"><code class="hljs lsl"><div class="hljs-line"><span class="hljs-comment line-number">1.</span>student <span class="hljs-number">2</span> doing homework <span class="hljs-number">0</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">2.</span>student <span class="hljs-number">1</span> doing homework <span class="hljs-number">0</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">3.</span>Main Thread <span class="hljs-number">0</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">4.</span>student <span class="hljs-number">3</span> doing homework <span class="hljs-number">0</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">5.</span>Main Thread <span class="hljs-number">1</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">6.</span>student <span class="hljs-number">2</span> doing homework <span class="hljs-number">1</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">7.</span>student <span class="hljs-number">1</span> doing homework <span class="hljs-number">1</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">8.</span>student <span class="hljs-number">3</span> doing homework <span class="hljs-number">1</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">9.</span>Main Thread <span class="hljs-number">2</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">10.</span>student <span class="hljs-number">3</span> doing homework <span class="hljs-number">2</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">11.</span>student <span class="hljs-number">1</span> doing homework <span class="hljs-number">2</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">12.</span>student <span class="hljs-number">2</span> doing homework <span class="hljs-number">2</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">13.</span>Main Thread <span class="hljs-number">3</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">14.</span>student <span class="hljs-number">3</span> doing homework <span class="hljs-number">3</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">15.</span>student <span class="hljs-number">1</span> doing homework <span class="hljs-number">3</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">16.</span>student <span class="hljs-number">2</span> doing homework <span class="hljs-number">3</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">17.</span>Main Thread <span class="hljs-number">4</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">18.</span>student <span class="hljs-number">3</span> doing homework <span class="hljs-number">4</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">19.</span>student <span class="hljs-number">2</span> doing homework <span class="hljs-number">4</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">20.</span>student <span class="hljs-number">1</span> doing homework <span class="hljs-number">4</span> hours.
</div><div class="hljs-line"><span class="hljs-comment line-number">21.</span>Main Thread <span class="hljs-number">5</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">22.</span>Main Thread <span class="hljs-number">6</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">23.</span>Main Thread <span class="hljs-number">7</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">24.</span>Main Thread <span class="hljs-number">8</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">25.</span>Main Thread <span class="hljs-number">9</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">26.</span>请按任意键继续. . .
</div></code></pre>



<h5 id="task方式结果同上">Task方式：(结果同上)</h5>



<pre class="prettyprint with-line-number hljs-dark"><code class="hljs arduino"><div class="hljs-line"><span class="hljs-comment line-number">1.</span><span class="hljs-keyword">using</span> System;
</div><div class="hljs-line"><span class="hljs-comment line-number">2.</span><span class="hljs-keyword">using</span> System.Threading;
</div><div class="hljs-line"><span class="hljs-comment line-number">3.</span><span class="hljs-keyword">using</span> System.Threading.Tasks;<span class="hljs-comment">//需要引入命名空间</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">4.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">5.</span><span class="hljs-keyword">namespace</span> Delegate
</div><div class="hljs-line"><span class="hljs-comment line-number">6.</span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">7.</span>    <span class="hljs-keyword">class</span> Program
</div><div class="hljs-line"><span class="hljs-comment line-number">8.</span>    {
</div><div class="hljs-line"><span class="hljs-comment line-number">9.</span>        <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> Main(<span class="hljs-keyword">string</span>[] args)
</div><div class="hljs-line"><span class="hljs-comment line-number">10.</span>        {
</div><div class="hljs-line"><span class="hljs-comment line-number">11.</span>            Student stu1 = <span class="hljs-keyword">new</span> Student() { ID = <span class="hljs-number">1</span>, PenColor = ConsoleColor.Red };<span class="hljs-comment">//创建三个学生实例</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">12.</span>            Student stu2 = <span class="hljs-keyword">new</span> Student() { ID = <span class="hljs-number">2</span>, PenColor = ConsoleColor.Blue };
</div><div class="hljs-line"><span class="hljs-comment line-number">13.</span>            Student stu3 = <span class="hljs-keyword">new</span> Student() { ID = <span class="hljs-number">3</span>, PenColor = ConsoleColor.Green };
</div><div class="hljs-line"><span class="hljs-comment line-number">14.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">15.</span>            <span class="hljs-built_in">Task</span> task1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Task</span>(<span class="hljs-keyword">new</span> Action(stu1.DoHomework));
</div><div class="hljs-line"><span class="hljs-comment line-number">16.</span>            <span class="hljs-built_in">Task</span> task2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Task</span>(<span class="hljs-keyword">new</span> Action(stu2.DoHomework));
</div><div class="hljs-line"><span class="hljs-comment line-number">17.</span>            <span class="hljs-built_in">Task</span> task3 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Task</span>(<span class="hljs-keyword">new</span> Action(stu3.DoHomework));
</div><div class="hljs-line"><span class="hljs-comment line-number">18.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">19.</span>            task1.Start();
</div><div class="hljs-line"><span class="hljs-comment line-number">20.</span>            task2.Start();
</div><div class="hljs-line"><span class="hljs-comment line-number">21.</span>            task3.Start();
</div><div class="hljs-line"><span class="hljs-comment line-number">22.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">23.</span>            <span class="hljs-built_in">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++)<span class="hljs-comment">//主线程</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">24.</span>            {
</div><div class="hljs-line"><span class="hljs-comment line-number">25.</span>                <span class="hljs-built_in">Console</span>.ForegroundColor = ConsoleColor.Cyan;
</div><div class="hljs-line"><span class="hljs-comment line-number">26.</span>                <span class="hljs-built_in">Console</span>.WriteLine(<span class="hljs-string">"Main Thread {0}"</span>, i);
</div><div class="hljs-line"><span class="hljs-comment line-number">27.</span>                Thread.Sleep(<span class="hljs-number">1000</span>);
</div><div class="hljs-line"><span class="hljs-comment line-number">28.</span>            }
</div><div class="hljs-line"><span class="hljs-comment line-number">29.</span>            <span class="hljs-comment">//运行结果：分支线程和主线程各自独立执行，谁都不等谁，有资源争抢现象</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">30.</span>        }
</div><div class="hljs-line"><span class="hljs-comment line-number">31.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">32.</span>    <span class="hljs-keyword">class</span> Student
</div><div class="hljs-line"><span class="hljs-comment line-number">33.</span>    {
</div><div class="hljs-line"><span class="hljs-comment line-number">34.</span>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> ID { <span class="hljs-built_in">get</span>; set; }
</div><div class="hljs-line"><span class="hljs-comment line-number">35.</span>        <span class="hljs-keyword">public</span> ConsoleColor PenColor { <span class="hljs-built_in">get</span>; set; }
</div><div class="hljs-line"><span class="hljs-comment line-number">36.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">37.</span>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> DoHomework()
</div><div class="hljs-line"><span class="hljs-comment line-number">38.</span>        {
</div><div class="hljs-line"><span class="hljs-comment line-number">39.</span>            <span class="hljs-built_in">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++)
</div><div class="hljs-line"><span class="hljs-comment line-number">40.</span>            {
</div><div class="hljs-line"><span class="hljs-comment line-number">41.</span>                <span class="hljs-comment">//Console.ForegroundColor()获取或设置控制台的前景色。</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">42.</span>                <span class="hljs-comment">//例：Console.BackgroundColor=ConsoleColor.Red;(背景色)</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">43.</span>                <span class="hljs-built_in">Console</span>.ForegroundColor = <span class="hljs-keyword">this</span>.PenColor;
</div><div class="hljs-line"><span class="hljs-comment line-number">44.</span>                <span class="hljs-built_in">Console</span>.WriteLine(<span class="hljs-string">"student {0} doing homework {1} hours."</span>, <span class="hljs-keyword">this</span>.ID, i);
</div><div class="hljs-line"><span class="hljs-comment line-number">45.</span>                Thread.Sleep(<span class="hljs-number">1000</span>);
</div><div class="hljs-line"><span class="hljs-comment line-number">46.</span>            }
</div><div class="hljs-line"><span class="hljs-comment line-number">47.</span>        }
</div><div class="hljs-line"><span class="hljs-comment line-number">48.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">49.</span>}
</div></code></pre>

<hr>

<h5 id="接口取代委托实例">接口取代委托实例:</h5>



<pre class="prettyprint with-line-number hljs-dark"><code class="hljs cs"><div class="hljs-line"><span class="hljs-comment line-number">1.</span><span class="hljs-keyword">using</span> System;
</div><div class="hljs-line"><span class="hljs-comment line-number">2.</span><span class="hljs-keyword">namespace</span> <span class="hljs-title">myConsole3</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">3.</span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">4.</span>    <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">5.</span>    {
</div><div class="hljs-line"><span class="hljs-comment line-number">6.</span>        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-keyword">string</span>[] args</span>)</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">7.</span><span class="hljs-function">        </span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">8.</span>            <span class="hljs-comment">//ProductFactory productFactory = new ProductFactory();//实例化生产工厂</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">9.</span>            <span class="hljs-comment">//WrapFactory wrapFactory = new WrapFactory();//实例化包装工厂</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">10.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">11.</span>            <span class="hljs-comment">//Func&lt;Product&gt; func1 = new Func&lt;Product&gt;(productFactory.MakePizza);//用委托来调用工厂的生产Pizza的方法</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">12.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">13.</span>            <span class="hljs-comment">//Logger logger = new Logger();//实例化日志类</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">14.</span>            <span class="hljs-comment">//Action&lt;Product&gt; action1 = new Action&lt;Product&gt;(logger.Log);//委托调用日志类中方法</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">15.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">16.</span>            <span class="hljs-comment">//Box box1 = wrapFactory.WrapProduct(func1,action1);//包装生产出来的产品</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">17.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">18.</span>            <span class="hljs-comment">//Console.WriteLine(box1.Product.Name);//输出产品名称</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">19.</span>            <span class="hljs-comment">//Console.WriteLine(box1.Product.Price);//输出产品价格</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">20.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">21.</span>            IProductFactory pizzaFactory= <span class="hljs-keyword">new</span> MakePizza();
</div><div class="hljs-line"><span class="hljs-comment line-number">22.</span>            Product product=pizzaFactory.Make();
</div><div class="hljs-line"><span class="hljs-comment line-number">23.</span>            Console.WriteLine(pizzaFactory.Make().Name);
</div><div class="hljs-line"><span class="hljs-comment line-number">24.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">25.</span>            Logger log = <span class="hljs-keyword">new</span> Logger();
</div><div class="hljs-line"><span class="hljs-comment line-number">26.</span>            WrapFactory wrapFactory = <span class="hljs-keyword">new</span> WrapFactory();
</div><div class="hljs-line"><span class="hljs-comment line-number">27.</span>            <span class="hljs-comment">//下面：因为wrapFactory类中的WrapProduct方法的返回值类型是Box,故被赋值的变量类型必须是Box</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">28.</span>            Box box1 =wrapFactory.WrapProduct(pizzaFactory, log);<span class="hljs-comment">//此处会触发日志生成，调用WrapProductFactory方法时因价格自动触发</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">29.</span>            <span class="hljs-comment">//Console.WriteLine(box1.Product.Name);</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">30.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">31.</span>            log.Log(product);<span class="hljs-comment">//这里是手动调用（触发）日志生成，不会因价格原因不输出</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">32.</span>        }
</div><div class="hljs-line"><span class="hljs-comment line-number">33.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">34.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">35.</span>    <span class="hljs-keyword">class</span> <span class="hljs-title">Logger</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">36.</span>    {
</div><div class="hljs-line"><span class="hljs-comment line-number">37.</span>        <span class="hljs-function"><span class="hljs-keyword">public</span>  <span class="hljs-keyword">void</span> <span class="hljs-title">Log</span>(<span class="hljs-params">Product product</span>)</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">38.</span><span class="hljs-function">        </span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">39.</span>            Console.WriteLine(<span class="hljs-string">"Product Name is {0},Price is {1},Create at {2}"</span>, product.Name, product.Price, DateTime.Now);
</div><div class="hljs-line"><span class="hljs-comment line-number">40.</span>        }
</div><div class="hljs-line"><span class="hljs-comment line-number">41.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">42.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">43.</span>    <span class="hljs-keyword">class</span> <span class="hljs-title">Product</span><span class="hljs-comment">//产品类</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">44.</span>    {
</div><div class="hljs-line"><span class="hljs-comment line-number">45.</span>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> Name { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
</div><div class="hljs-line"><span class="hljs-comment line-number">46.</span>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> Price { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
</div><div class="hljs-line"><span class="hljs-comment line-number">47.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">48.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">49.</span>    <span class="hljs-keyword">class</span> <span class="hljs-title">Box</span><span class="hljs-comment">//包装类</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">50.</span>    {
</div><div class="hljs-line"><span class="hljs-comment line-number">51.</span>        <span class="hljs-keyword">public</span> Product Product { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
</div><div class="hljs-line"><span class="hljs-comment line-number">52.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">53.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">54.</span>    <span class="hljs-comment">//class WrapFactory//包装工厂类</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">55.</span>    <span class="hljs-comment">//{</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">56.</span>    <span class="hljs-comment">//    public Box WrapProduct(Func&lt;Product&gt; getProduct,Action&lt;Product&gt; action)</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">57.</span>    <span class="hljs-comment">//    {</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">58.</span>    <span class="hljs-comment">//        Box box = new Box();</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">59.</span>    <span class="hljs-comment">//        Product product = getProduct();</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">60.</span>    <span class="hljs-comment">//        box.Product = product;</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">61.</span>    <span class="hljs-comment">//        if (product.Price &gt; 50)//当产品价格高于50时，输出日志</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">62.</span>    <span class="hljs-comment">//        {</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">63.</span>    <span class="hljs-comment">//            action(product);</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">64.</span>    <span class="hljs-comment">//        }</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">65.</span>    <span class="hljs-comment">//        return box;</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">66.</span>    <span class="hljs-comment">//    }</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">67.</span>    <span class="hljs-comment">//}</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">68.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">69.</span>    <span class="hljs-keyword">class</span> <span class="hljs-title">WrapFactory</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">70.</span>    {
</div><div class="hljs-line"><span class="hljs-comment line-number">71.</span>        <span class="hljs-function"><span class="hljs-keyword">public</span> Box <span class="hljs-title">WrapProduct</span>(<span class="hljs-params">IProductFactory iProductFactory,Logger logger</span>)</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">72.</span><span class="hljs-function">        </span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">73.</span>            Box box = <span class="hljs-keyword">new</span> Box();
</div><div class="hljs-line"><span class="hljs-comment line-number">74.</span>            Product product = iProductFactory.Make();
</div><div class="hljs-line"><span class="hljs-comment line-number">75.</span>            box.Product = product;
</div><div class="hljs-line"><span class="hljs-comment line-number">76.</span>            <span class="hljs-keyword">if</span> (product.Price&gt;<span class="hljs-number">50</span>)
</div><div class="hljs-line"><span class="hljs-comment line-number">77.</span>            {
</div><div class="hljs-line"><span class="hljs-comment line-number">78.</span>                logger.Log(product);
</div><div class="hljs-line"><span class="hljs-comment line-number">79.</span>            }
</div><div class="hljs-line"><span class="hljs-comment line-number">80.</span>            <span class="hljs-keyword">return</span> box;
</div><div class="hljs-line"><span class="hljs-comment line-number">81.</span>        }
</div><div class="hljs-line"><span class="hljs-comment line-number">82.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">83.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">84.</span>    <span class="hljs-comment">//class ProductFactory//生产工厂类</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">85.</span>    <span class="hljs-comment">//{</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">86.</span>    <span class="hljs-comment">//    public Product MakePizza()</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">87.</span>    <span class="hljs-comment">//    {</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">88.</span>    <span class="hljs-comment">//        Product product = new Product() { Name = "Pizza", Price = 100 };//产品命名和定价</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">89.</span>    <span class="hljs-comment">//        return product;</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">90.</span>    <span class="hljs-comment">//    }</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">91.</span>    <span class="hljs-comment">//}</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">92.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">93.</span>    <span class="hljs-keyword">interface</span> <span class="hljs-title">IProductFactory</span><span class="hljs-comment">//调用接口来取代委托</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">94.</span>    {
</div><div class="hljs-line"><span class="hljs-comment line-number">95.</span>        <span class="hljs-function">Product <span class="hljs-title">Make</span>(<span class="hljs-params"></span>)</span>;<span class="hljs-comment">//抽象的生产方法</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">96.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">97.</span>    <span class="hljs-keyword">class</span> <span class="hljs-title">MakePizza</span> : <span class="hljs-title">IProductFactory</span><span class="hljs-comment">//快捷键：光标在这里，按Ctrl+.   自动生成抽象方法实现</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">98.</span>    {
</div><div class="hljs-line"><span class="hljs-comment line-number">99.</span>        <span class="hljs-function"><span class="hljs-keyword">public</span> Product <span class="hljs-title">Make</span>(<span class="hljs-params"></span>)</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">100.</span><span class="hljs-function">        </span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">101.</span>            Product product = <span class="hljs-keyword">new</span> Product { Name = <span class="hljs-string">"Pizza"</span>, Price = <span class="hljs-number">100</span> };
</div><div class="hljs-line"><span class="hljs-comment line-number">102.</span>            <span class="hljs-keyword">return</span> product;
</div><div class="hljs-line"><span class="hljs-comment line-number">103.</span>        }
</div><div class="hljs-line"><span class="hljs-comment line-number">104.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">105.</span>}
</div></code></pre>



<h5 id="运行结果-2">运行结果：</h5>



<pre class="prettyprint with-line-number hljs-dark"><code class="hljs delphi"><div class="hljs-line"><span class="hljs-comment line-number">1.</span>Pizza
</div><div class="hljs-line"><span class="hljs-comment line-number">2.</span>Product <span class="hljs-keyword">Name</span> <span class="hljs-keyword">is</span> Pizza,Price <span class="hljs-keyword">is</span> <span class="hljs-number">100</span>,Create at <span class="hljs-number">2018</span>/<span class="hljs-number">12</span>/<span class="hljs-number">26</span> <span class="hljs-number">14</span>:<span class="hljs-number">52</span>:<span class="hljs-number">32</span><span class="hljs-comment">//这是自动调用日志类中方法写日志</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">3.</span>Product <span class="hljs-keyword">Name</span> <span class="hljs-keyword">is</span> Pizza,Price <span class="hljs-keyword">is</span> <span class="hljs-number">100</span>,Create at <span class="hljs-number">2018</span>/<span class="hljs-number">12</span>/<span class="hljs-number">26</span> <span class="hljs-number">14</span>:<span class="hljs-number">52</span>:<span class="hljs-number">32</span><span class="hljs-comment">//这是手动调用</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">4.</span>请按任意键继续. . .
</div></code></pre></div></body></html>